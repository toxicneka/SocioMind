from aiogram import Router, F
from aiogram.types import Message
from aiogram.filters import Command
from aiogram.enums import ChatType
from services.gigachat import GigaChatService
from utils.helpers import get_user_type, get_all_users_with_types
from datetime import datetime, timedelta
import asyncio

router = Router()
gigachat_service = GigaChatService()

@router.message(Command("report"), F.chat.type.in_({ChatType.GROUP, ChatType.SUPERGROUP}))
async def cmd_report(message: Message):
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —É –±–æ—Ç–∞
    try:
        bot_member = await message.bot.get_chat_member(message.chat.id, message.bot.id)
        if bot_member.status not in ['administrator', 'creator']:
            await message.answer(
                "‚ùå <b>–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≥—Ä—É–ø–ø—ã –±–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º!</b>\n\n"
                "–ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –±–æ—Ç—É –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.",
                parse_mode="HTML"
            )
            return
    except Exception as e:
        await message.answer("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –±–æ—Ç–∞. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç —è–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.")
        return

    await message.answer("üîç –ù–∞—á–∏–Ω–∞—é –∞–Ω–∞–ª–∏–∑ –≥—Ä—É–ø–ø—ã...")

    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≥—Ä—É–ø–ø—ã
        members = await get_all_group_members(message)
        
        if not members:
            await message.answer("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—á–∞—Å—Ç–Ω–∏–∫–∞—Ö –≥—Ä—É–ø–ø—ã.")
            return

        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏–∑ –ë–î
        typed_users = await get_all_users_with_types()
        typed_user_ids = {user['user_id'] for user in typed_users}
        typed_users_dict = {user['user_id']: user for user in typed_users}

        typed_members = 0
        members_info = []
        member_ids = set()
        
        for member in members:
            user_id = member.user.id
            if user_id in member_ids:
                continue
            member_ids.add(user_id)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –ª–∏—á–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if user_id in typed_user_ids:
                typed_members += 1
                username = f"@{member.user.username}" if member.user.username else member.user.first_name
                personality_type = typed_users_dict[user_id]['personality_type']
                members_info.append(f"‚Ä¢ {username}: {personality_type}")

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ 70% –ø–æ—Ä–æ–≥–∞
        total_members = len(member_ids)
        if total_members == 0:
            await message.answer("‚ùå –í –≥—Ä—É–ø–ø–µ –Ω–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.")
            return

        percentage = (typed_members / total_members) * 100
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        stats_message = (
            f"üìä <b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥—Ä—É–ø–ø—ã \"{message.chat.title}\":</b>\n"
            f"–í—Å–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: {total_members}\n"
            f"–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ: {typed_members}\n"
            f"–ü—Ä–æ—Ü–µ–Ω—Ç: {percentage:.1f}%"
        )
        
        if members_info:
            stats_message += f"\n\n<b>–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏:</b>\n" + "\n".join(members_info)
        
        await message.answer(stats_message, parse_mode="HTML")

        if percentage < 70:
            await message.answer(
                f"‚ùå <b>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</b>\n"
                f"–ù–µ–æ–±—Ö–æ–¥–∏–º–æ: >70% –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤\n\n"
                f"–ß—Ç–æ–±—ã –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç, –Ω–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É @{(await message.bot.get_me()).username} –∫–æ–º–∞–Ω–¥—É /test",
                parse_mode="HTML"
            )
            return

        await message.answer("üîÆ <b>–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –¥–∏–Ω–∞–º–∏–∫—É –≥—Ä—É–ø–ø—ã –∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞ 7 –¥–Ω–µ–π...</b>", parse_mode="HTML")
        
        # –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ 7 –¥–Ω–µ–π
        chat_history = await get_chat_history_last_7_days(message)
        
        # –ê–Ω–∞–ª–∏–∑ –≥—Ä—É–ø–ø—ã —Å —É—á–µ—Ç–æ–º –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
        analysis = await analyze_group_messages(message, members_info, total_members, typed_members, chat_history)
        await message.answer(analysis, parse_mode="HTML")
        
    except Exception as e:
        await message.answer(
            f"‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –≥—Ä—É–ø–ø—ã: {str(e)}\n"
            f"–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ –≥—Ä—É–ø–ø–µ."
        )
        print(f"Error in group analysis: {e}")

async def get_all_group_members(message: Message):
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≥—Ä—É–ø–ø—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º"""
    members = []
    try:
        # –ü–æ–ª—É—á–∞–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ - —ç—Ç–æ –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
        admins = await message.bot.get_chat_administrators(message.chat.id)
        for admin in admins:
            if not admin.user.is_bot:
                members.append(admin)
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö
        # —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –∏–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö ID
        # –≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ Telegram API:cite[4]
        
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: {e}")
    
    return members

async def get_chat_history_last_7_days(message: Message) -> str:
    """–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π"""
    try:
        # –í python-telegram-bot –Ω–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏
        # –ú–æ–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
        # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Pyrogram:cite[2]
        
        messages_text = []
        # –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ –±–æ—Ç–∞
        # –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Pyrogram
        
        return "–î–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Pyrogram. –¢–µ–∫—É—â–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∏—Å—Ç–æ—Ä–∏–∏."
        
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞: {e}")
        return "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π."

async def analyze_group_messages(message: Message, members_info: list, total_members: int, typed_members: int, chat_history: str) -> str:
    """–ê–Ω–∞–ª–∏–∑ –≥—Ä—É–ø–ø—ã —Å –ø–æ–º–æ—â—å—é GigaChat —Å —É—á–µ—Ç–æ–º –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ 7 –¥–Ω–µ–π"""
    
    prompt = f"""
    –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –¥–∏–Ω–∞–º–∏–∫—É –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–æ–≤ –ª–∏—á–Ω–æ—Å—Ç–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π.
    –î–∞–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.

    –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ì–†–£–ü–ü–ï:
    - –ù–∞–∑–≤–∞–Ω–∏–µ: "{message.chat.title}"
    - –í—Å–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: {total_members}
    - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö: {typed_members}

    –¢–ò–ü–´ –õ–ò–ß–ù–û–°–¢–ò –£–ß–ê–°–¢–ù–ò–ö–û–í:
    {chr(10).join(members_info)}

    –ò–°–¢–û–†–ò–Ø –°–û–û–ë–©–ï–ù–ò–ô –ò–ó –ß–ê–¢–ê (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π):
    {chat_history}

    –ü–†–û–ê–ù–ê–õ–ò–ó–ò–†–£–ô –∏ –¥–∞–π –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ø–æ:
    1. –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ª–∏—á–Ω–æ—Å—Ç–∏
    2. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º –∑–æ–Ω–∞–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å
    3. –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —Ä–æ–ª–µ–π –≤ –∫–æ–º–∞–Ω–¥–µ
    4. –£–ª—É—á—à–µ–Ω–∏—é –≥—Ä—É–ø–ø–æ–≤–æ–π –¥–∏–Ω–∞–º–∏–∫–∏ –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞
    5. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏—è–º –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω –∫–æ–º–∞–Ω–¥—ã

    –ë—É–¥—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–µ–Ω –∏ –¥–∞–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ, –≤—ã–ø–æ–ª–Ω–∏–º—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.
    –û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ –ø–æ–ª–µ–∑–Ω—ã–º –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –∫–æ–º–∞–Ω–¥—ã.
    """

    try:
        if gigachat_service.enabled:
            response = await gigachat_service.generate_group_analysis(prompt)
            return response
        else:
            # –ó–∞–≥–ª—É—à–∫–∞ –µ—Å–ª–∏ GigaChat –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω
            return f"""üìä <b>–û—Ç—á–µ—Ç –¥–ª—è –≥—Ä—É–ø–ø—ã "{message.chat.title}"</b>

üë• <b>–£—á–∞—Å—Ç–Ω–∏–∫–∏ ({typed_members}/{total_members} –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã):</b>
{chr(10).join(members_info)}

üìù <b>–ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ 7 –¥–Ω–µ–π:</b>
{chat_history[:500]}...

üí° <b>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–æ–±—â–∏–µ):</b>
‚Ä¢ –°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—á–∏–µ –ø–∞—Ä—ã, —É—á–∏—Ç—ã–≤–∞—è —Ç–∏–ø—ã –ª–∏—á–Ω–æ—Å—Ç–∏
‚Ä¢ –û—Ä–≥–∞–Ω–∏–∑—É–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤—ã –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –ø—Ä–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –∑–∞–¥–∞—á
‚Ä¢ –†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ —á–µ—Ç–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

üîÆ <b>–î–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å AI:</b>
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ API –∫–ª—é—á GigaChat –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–æ—Ç–∞"""
            
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –≥—Ä—É–ø–ø—ã: {e}")
        return f"""üìä <b>–û—Ç—á–µ—Ç –¥–ª—è –≥—Ä—É–ø–ø—ã "{message.chat.title}"</b>

üë• <b>–°–æ—Å—Ç–∞–≤ –≥—Ä—É–ø–ø—ã:</b>
{chr(10).join(members_info)}

üí° <b>–û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</b>
‚Ä¢ –£—á–∏—Ç—ã–≤–∞–π—Ç–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å—Ç–∏–ª—è—Ö
‚Ä¢ –°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —Ä–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã
‚Ä¢ –ü–æ–æ—â—Ä—è–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –ª–∏—á–Ω–æ—Å—Ç–∏"""